<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mondo Phenotypes Example (IN PROGRESS) &mdash; oaklib  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=046fa432"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="NCIT Examples" href="../NCIT/index.html" />
    <link rel="prev" title="Analysis of differences with different gene to disease sources" href="Disease2GeneAnalysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            oaklib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/index.html">The OAK Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../packages/index.html">OAK Library Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli.html">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datamodels/index.html">Datamodels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howtos/index.html">How-To Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Commands/index.html">Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Ontologies</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../CHEBI/index.html">CHEBI Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CL/index.html">CL Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ENVO/index.html">ENVO Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GO/index.html">GO Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../HP/index.html">HP Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LOINC/index.html">LOINC Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../MAXO/index.html">MAXO Examples</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">MONDO Examples</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Disease2GeneAnalysis.html">Analysis of differences with different gene to disease sources</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Mondo Phenotypes Example (IN PROGRESS)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../NCIT/index.html">NCIT Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OBA/index.html">OBA Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../OMOP/index.html">OMOP Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PHENIO/index.html">PhenIO Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SchemaDotOrg/index.html">Schema.org Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Adapters/index.html">Adapter Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Interfaces/index.html">Interfaces Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdHoc/index.html">Ad Hoc Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">oaklib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Examples</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Ontologies</a></li>
          <li class="breadcrumb-item"><a href="index.html">MONDO Examples</a></li>
      <li class="breadcrumb-item active">Mondo Phenotypes Example (IN PROGRESS)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/examples/Ontologies/MONDO/Mondo-pheno-summaries.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Mondo-Phenotypes-Example-(IN-PROGRESS)">
<h1>Mondo Phenotypes Example (IN PROGRESS)<a class="headerlink" href="#Mondo-Phenotypes-Example-(IN-PROGRESS)" title="Link to this heading"></a></h1>
<section id="Help-Option">
<h2>Help Option<a class="headerlink" href="#Help-Option" title="Link to this heading"></a></h2>
<p>You can get help on any OAK command using <code class="docutils literal notranslate"><span class="pre">--help</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>runoak<span class="w"> </span>enrichment<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Usage: runoak enrichment [OPTIONS] [TERMS]...

  Run class enrichment analysis.

  Given a sample file of identifiers (e.g. gene IDs), plus a set of
  associations (e.g. gene to term associations, return the terms that are
  over-represented in the sample set.

  Example:

      runoak -i sqlite:obo:uberon -g gene2anat.txt -G g2t enrichment -U my-
      genes.txt -O csv

  This runs an enrichment using Uberon on my-genes.txt, using the
  gene2anat.txt file as the association file (assuming simple gene-to-term
  format). The output is in CSV format.

  It is recommended you always provide a background set, including all the
  entity identifiers considered in the experiment.

  You can specify --filter-redundant to filter out redundant terms. This will
  block reporting of any terms that are either subsumed by or subsume a lower
  p-value term that is already reported.

  For a full example, see:

     https://github.com/INCATools/ontology-access-
     kit/blob/main/notebooks/Commands/Enrichment.ipynb

  Note that it is possible to run &#34;pseudo-enrichments&#34; on term lists only by
  passing no associations and using --ontology-only. This creates a fake
  association set that is simply reflexive relations between each term and
  itself. This can be useful for summarizing term lists, but note that
  P-values may not be meaningful.

Options:
  -o, --output FILENAME           Output file, e.g. obo file
  -p, --predicates TEXT           A comma-separated list of predicates. This
                                  may be a shorthand (i, p) or CURIE
  --autolabel / --no-autolabel    If set, results will automatically have
                                  labels assigned  [default: autolabel]
  -O, --output-type TEXT          Desired output type
  -o, --output FILENAME           Output file, e.g. obo file
  --ontology-only / --no-ontology-only
                                  If true, perform a pseudo-enrichment
                                  analysis treating each term as an
                                  association to itself.  [default: no-
                                  ontology-only]
  --cutoff FLOAT                  The cutoff for the p-value; any p-values
                                  greater than this are not reported.
                                  [default: 0.05]
  -U, --sample-file FILENAME      file containing input list of entity IDs
                                  (e.g. gene IDs)  [required]
  -B, --background-file FILENAME  file containing background list of entity
                                  IDs (e.g. gene IDs)
  --association-predicates TEXT   A comma-separated list of predicates for the
                                  association relation
  --filter-redundant / --no-filter-redundant
                                  If true, filter out redundant terms
  --allow-labels / --no-allow-labels
                                  If true, allow labels as well as CURIEs in
                                  the input files
  --help                          Show this message and exit.
</pre></div></div>
</div>
</section>
<section id="Download-example-file-and-setup">
<h2>Download example file and setup<a class="headerlink" href="#Download-example-file-and-setup" title="Link to this heading"></a></h2>
<p>We will use the HPO Association file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>mkdir<span class="w"> </span>-p<span class="w"> </span>input
<span class="o">!</span>curl<span class="w"> </span>-L<span class="w"> </span>-s<span class="w"> </span>http://purl.obolibrary.org/obo/hp/hpoa/phenotype.hpoa<span class="w"> </span>&gt;<span class="w"> </span>input/hpoa.tsv
</pre></div>
</div>
</div>
<p>next we will set up an hpo alias</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">hp</span> <span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">sqlite</span><span class="p">:</span><span class="n">obo</span><span class="p">:</span><span class="n">hp</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">mondo</span> <span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">sqlite</span><span class="p">:</span><span class="n">obo</span><span class="p">:</span><span class="n">mondo</span>
</pre></div>
</div>
</div>
<p>Test this out by querying for associations for a particular orpha disease.</p>
<p>We need to pass in the association file we downloaded, as well as specify the file type (with <code class="docutils literal notranslate"><span class="pre">-G</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hp</span> <span class="o">-</span><span class="n">G</span> <span class="n">hpoa</span> <span class="o">-</span><span class="n">g</span> <span class="nb">input</span><span class="o">/</span><span class="n">hpoa</span><span class="o">.</span><span class="n">tsv</span> <span class="n">associations</span> <span class="o">-</span><span class="n">Q</span> <span class="n">subject</span> <span class="n">ORPHA</span><span class="p">:</span><span class="mi">1899</span> <span class="o">-</span><span class="n">O</span> <span class="n">csv</span> <span class="o">|</span> <span class="n">head</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
subject predicate       object  object_label    property_values subject_label   predicate_label negated publications    evidence_type   supporting_objects      primary_knowledge_source        aggregator_knowledge_source     subject_closure subject_closure_label   object_closure  object_closure_label    comments
ORPHA:1899      None    HP:0000963      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0000974      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0001001      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0001252      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0001373      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0001385      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0001387      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0002300      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
ORPHA:1899      None    HP:0002381      None            Arthrochalasia Ehlers-Danlos syndrome   None    None            None            None    None
</pre></div></div>
</div>
</section>
<section id="Rollup">
<h2>Rollup<a class="headerlink" href="#Rollup" title="Link to this heading"></a></h2>
<p>Next we will roll up annotations. We choose two representations of the same EDS concept, from Orphanet and OMIM (note we can provide as many diseases as we like).</p>
<p>We will use HPO terms roughly inspired by <a class="reference external" href="https://www.omim.org/clinicalSynopsis/130060">https://www.omim.org/clinicalSynopsis/130060</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mondo</span> <span class="n">labels</span> <span class="o">.</span><span class="n">parents</span><span class="o">//</span><span class="n">p</span><span class="o">=</span><span class="n">RO</span><span class="p">:</span><span class="mi">0004003</span> <span class="p">[</span> <span class="o">.</span><span class="n">desc</span><span class="o">//</span><span class="n">p</span><span class="o">=</span><span class="n">i</span> <span class="n">EDS</span> <span class="p">]</span> <span class="o">-</span><span class="n">O</span> <span class="n">csv</span> <span class="o">&gt;</span> <span class="n">output</span><span class="o">/</span><span class="n">EDS</span><span class="o">-</span><span class="n">genes</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>head<span class="w"> </span>output/EDS-genes.tsv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
id      label
HGNC:11976      TNXB
HGNC:1246       C1R
HGNC:1247       C1S
HGNC:17978      B3GALT6
HGNC:18625      FKBP14
HGNC:20859      SLC39A13
HGNC:21144      DSE
HGNC:218        ADAMTS2
HGNC:2188       COL12A1
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>runoak<span class="w"> </span>-i<span class="w"> </span>translator:<span class="w"> </span>normalize<span class="w"> </span>-M<span class="w"> </span>NCBIGene<span class="w"> </span><span class="o">[</span><span class="w"> </span>.parents//p<span class="o">=</span>RO:0004003<span class="w"> </span><span class="o">[</span><span class="w"> </span>.desc//p<span class="o">=</span>i<span class="w"> </span>EDS<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NotImplementedError
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Disease2GeneAnalysis.html" class="btn btn-neutral float-left" title="Analysis of differences with different gene to disease sources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../NCIT/index.html" class="btn btn-neutral float-right" title="NCIT Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, OAK developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>