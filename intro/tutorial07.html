<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Part 7: SQLite files &mdash; oaklib  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=046fa432"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 8: Applying Changes to Ontologies" href="tutorial08.html" />
    <link rel="prev" title="Part 6: Working With OWL" href="tutorial06.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            oaklib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial01.html">Part 1: Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial02.html">Part 2: Basic Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial03.html">Part 3: Triplestore Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial04.html">Part 4: OboGraphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial05.html">Part 5: Graph Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial06.html">Part 6: Working With OWL</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Part 7: SQLite files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download-a-sqlite-file">Download a SQLite file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fetching-ready-made-sqlite-files">Fetching ready-made SQLite files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-your-own-sqlite-files">Building your own SQLite files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#with-docker">With docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="#without-docker">Without docker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#validating-an-ontology">Validating an ontology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-rdbmss">Other RDBMSs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-orm">Python ORM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial08.html">Part 8: Applying Changes to Ontologies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">The OAK Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packages/index.html">OAK Library Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datamodels/index.html">Datamodels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtos/index.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">oaklib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorial</a></li>
      <li class="breadcrumb-item active">Part 7: SQLite files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/intro/tutorial07.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="part-7-sqlite-files">
<span id="tutorial07"></span><h1>Part 7: SQLite files<a class="headerlink" href="#part-7-sqlite-files" title="Link to this heading"></a></h1>
<p>The most efficient way to work with OAK is through SQLite files. OAK accepts SQLite files that follow the <a class="reference external" href="https://github.com/INCATools/semantic-sql">Semantic SQL</a> schema.</p>
<p>The <a class="reference internal" href="../packages/implementations/sqldb.html#sql-implementation"><span class="std std-ref">SQL Database Adapter</span></a> wraps SQLite or any relational database.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You may also want to try the <a class="reference external" href="https://github.com/INCATools/semantic-sql/blob/main/notebooks/SemanticSQL-Tutorial.ipynb">Semantic-SQL tutorial</a></p>
</div>
<section id="download-a-sqlite-file">
<h2>Download a SQLite file<a class="headerlink" href="#download-a-sqlite-file" title="Link to this heading"></a></h2>
<p>You can download ready made SQLite files for any <span class="xref std std-term">OBO</span> Library ontology</p>
<p>For example: the Cell Ontology (CL) is available from <a class="reference external" href="https://s3.amazonaws.com/bbop-sqlite/cl.db.gz">https://s3.amazonaws.com/bbop-sqlite/cl.db.gz</a></p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">bbop</span><span class="o">-</span><span class="n">sqlite</span><span class="o">/</span><span class="n">cl</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">gz</span>
<span class="n">gzip</span> <span class="o">-</span><span class="n">d</span> <span class="n">cl</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">gz</span>
<span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">cl</span><span class="o">.</span><span class="n">db</span> <span class="n">relationships</span> <span class="s2">&quot;enteric neuron&quot;</span>
</pre></div>
</div>
<p>This will show all relationships centered around the subject of CL:0007011:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Ancestor statistics</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>id</p></th>
<th class="head"><p>label</p></th>
<th class="head"><p>visits</p></th>
<th class="head"><p>distance</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>subject</p></td>
<td><p>predicate</p></td>
<td><p>object</p></td>
<td><p>subject_label</p></td>
<td><p>predicate_label</p></td>
<td><p>object_label</p></td>
</tr>
<tr class="row-odd"><td><p>CL:0007011</p></td>
<td><p>BFO:0000050</p></td>
<td><p>UBERON:0002005</p></td>
<td><p>enteric neuron</p></td>
<td><p>part of</p></td>
<td><p>enteric nervous system</p></td>
</tr>
<tr class="row-even"><td><p>CL:0007011</p></td>
<td><p>RO:0002100</p></td>
<td><p>UBERON:0002005</p></td>
<td><p>enteric neuron</p></td>
<td><p>has soma location</p></td>
<td><p>enteric nervous system</p></td>
</tr>
<tr class="row-odd"><td><p>CL:0007011</p></td>
<td><p>RO:0002202</p></td>
<td><p>CL:0002607</p></td>
<td><p>enteric neuron</p></td>
<td><p>develops from</p></td>
<td><p>migratory enteric neural crest cell</p></td>
</tr>
<tr class="row-even"><td><p>CL:0007011</p></td>
<td><p>rdfs:subClassOf</p></td>
<td><p>CL:0000029</p></td>
<td><p>enteric neuron</p></td>
<td><p>None</p></td>
<td><p>neural crest derived neuron</p></td>
</tr>
<tr class="row-odd"><td><p>CL:0007011</p></td>
<td><p>rdfs:subClassOf</p></td>
<td><p>CL:0000107</p></td>
<td><p>enteric neuron</p></td>
<td><p>None</p></td>
<td><p>autonomic neuron</p></td>
</tr>
</tbody>
</table>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>OAK will automatically treat anything with <code class="docutils literal notranslate"><span class="pre">.db</span></code> as a sqlite database</p>
</div>
<p>You can be more explicit and force the sqlite adapter to be used, regardless of suffix using a <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> <span class="xref std std-ref">selector</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">bbop</span><span class="o">-</span><span class="n">sqlite</span><span class="o">/</span><span class="n">cl</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">gz</span>
<span class="n">gzip</span> <span class="o">-</span><span class="n">d</span> <span class="n">cl</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">gz</span>
<span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">sqlite</span><span class="p">:</span><span class="n">cl</span><span class="o">.</span><span class="n">db</span> <span class="n">relationships</span> <span class="s2">&quot;enteric neuron&quot;</span>
</pre></div>
</div>
</section>
<section id="fetching-ready-made-sqlite-files">
<h3>Fetching ready-made SQLite files<a class="headerlink" href="#fetching-ready-made-sqlite-files" title="Link to this heading"></a></h3>
<p>You can also specify that the sqlite file should be loaded from the repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">sqlite</span><span class="p">:</span><span class="n">obo</span><span class="p">:</span><span class="n">pato</span> <span class="n">search</span> <span class="n">t</span><span class="o">~</span><span class="n">shape</span>
</pre></div>
</div>
<p>This will download the pato.db sqlite file once, and cache it.</p>
<p>PyStow is used to cache the file, and the default location is <code class="docutils literal notranslate"><span class="pre">~/.data/oaklib</span></code>.</p>
<p>By default, a cached SQLite file will be automatically refreshed (downloaded
again) if it is older than 7 days. For details on how to alter the behavior of
the cache, see the <a class="reference internal" href="../cli.html#cache-control"><span class="std std-ref">Cache Control</span></a> section in the CLI documentation.</p>
</section>
</section>
<section id="building-your-own-sqlite-files">
<h2>Building your own SQLite files<a class="headerlink" href="#building-your-own-sqlite-files" title="Link to this heading"></a></h2>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">semsql</span></code> command that should be pre-installed with OAK</p>
<p>There are two paths</p>
<ul class="simple">
<li><p>using ODK docker</p></li>
<li><p>without docker, with dependencies pre-installed</p></li>
</ul>
<section id="with-docker">
<h3>With docker<a class="headerlink" href="#with-docker" title="Link to this heading"></a></h3>
<p>If you have an OWL file in <code class="docutils literal notranslate"><span class="pre">./path/to/obi.owl</span></code></p>
<p>Then you can do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run -w /work  -v `pwd`:/work --rm -ti obolibrary/odkfull:dev semsql make path/to/obi.db
</pre></div>
</div>
<p>This will do a one-time build of obi.db, using the ODK docker. You will need Docker installed (but you don’t need to do anything else)</p>
<p>You can then query the file as normal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">obi</span><span class="o">.</span><span class="n">db</span> <span class="n">info</span> <span class="n">assay</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>for this to work, the OWL file <strong>must</strong> be in RDF/XML. Also, imports merging will NOT be done by default,
please merge in advance using ROBOT if this is your desired behavior.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The recipe above works for any OWL file in a descendant of your current folder.
If you wish to use a file outside of your current folder, then change the
option from <code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">`pwd`:/work</span></code> to <code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">/path/to/:/work/</span></code></p>
</div>
</section>
<section id="without-docker">
<h3>Without docker<a class="headerlink" href="#without-docker" title="Link to this heading"></a></h3>
<p><strong>Prerequisites</strong></p>
<p>For this to work you will need to install the following dependencies and ensure they’re loaded in your <cite>PATH</cite>.</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/balhoff/relation-graph#installation">relation-graph</a></p></li>
<li><p><a class="reference external" href="https://github.com/ontodev/rdftab.rs#installation">rdftab</a></p></li>
<li><p><cite>riot</cite> - On MacOS, can install using <a class="reference external" href="https://brew.sh/">HomeBrew</a> via: <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">jena</span></code></p></li>
</ol>
<p>Then, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">semsql</span> <span class="n">make</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">obi</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
<p>Consult the <a class="reference external" href="https://github.com/INCATools/semantic-sql">SemSQL docs</a> for more details.</p>
<p>In future we hope to wrap these more seamlessly in Python.</p>
</section>
</section>
<section id="validating-an-ontology">
<h2>Validating an ontology<a class="headerlink" href="#validating-an-ontology" title="Link to this heading"></a></h2>
<p>the SQLite implementation is the most efficient way to validate an ontology</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runoak</span> <span class="o">-</span><span class="n">i</span> <span class="n">sqlite</span><span class="p">:</span><span class="n">obo</span><span class="p">:</span><span class="n">cl</span> <span class="n">validate</span>
</pre></div>
</div>
</section>
<section id="other-rdbmss">
<h2>Other RDBMSs<a class="headerlink" href="#other-rdbmss" title="Link to this heading"></a></h2>
<p>We avoid SQLite specific features so in theory OAK should work with any RDBMS that follows the semantic-sql schema,
but currently SQLite is the focus of development and testing</p>
</section>
<section id="python-orm">
<h2>Python ORM<a class="headerlink" href="#python-orm" title="Link to this heading"></a></h2>
<p>OAK abstracts away the details of the underlying database and ways of accessing it, but for some purposes you
may wish to write direct SQL or use the ORM layer. Consult SemSQL docs for details.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial06.html" class="btn btn-neutral float-left" title="Part 6: Working With OWL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial08.html" class="btn btn-neutral float-right" title="Part 8: Applying Changes to Ontologies" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2026, OAK developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>